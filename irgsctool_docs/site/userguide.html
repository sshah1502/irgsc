<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="img/favicon.ico" rel="shortcut icon"/>
<title>UserGuide - irgsctool</title>
<link href="css/theme.css" rel="stylesheet"/>
<link href="css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" rel="stylesheet"/>
<link href="assets/_mkdocstrings.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "UserGuide";
        var mkdocs_page_input_path = "userguide.md";
        var mkdocs_page_url = null;
      </script>
<script defer="" src="js/jquery-3.6.0.min.js"></script>
<!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link href="assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            </style><script src="assets/javascripts/glightbox.min.js"></script></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a href="index.html">
<img alt="Logo" class="logo" src="img/TMT_LOGO.PNG"/>
</a>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal current" href="userguide.html">UserGuide</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#generate-irgsc">Generate IRGSC</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting">irgsctool._fitting</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting.GenerateIRGSC">GenerateIRGSC</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._fitting.GenerateIRGSC.generate_irgsc">generate_irgsc()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting.calc_sf">calc_sf()</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting.compute_dquad">compute_dquad()</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting.find_nearest">find_nearest()</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._fitting.stdv">stdv()</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#validate-the-generated-irgsc">Validate the generated IRGSC</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._validate">irgsctool._validate</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._validate.Validate">Validate</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._validate.Validate.validate">validate()</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apireference.html">API</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="index.html">irgsctool</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a alt="Docs" class="icon icon-home" href="index.html"></a> Â»</li>
<li>UserGuide</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="user-guide">User Guide</h1>
<h2 id="generate-irgsc">Generate IRGSC</h2>
<div class="doc doc-object doc-module">
<a id="irgsctool._fitting"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._fitting.GenerateIRGSC">
<code>GenerateIRGSC</code>
</h2>
<div class="doc doc-contents">
<p>The <strong> class </strong> to generate IRGSC.</p>
<p>It generates a catalog of probable stellar sources in the PANSTARRS data
    with their computed magnitudes, astrometric information from
    GAIA DR3 data, best fitted model parameters and flags.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GenerateIRGSC</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    The &lt;strong&gt; class &lt;/strong&gt; to generate IRGSC.</span>

<span class="sd">    It generates a catalog of probable stellar sources in the PANSTARRS data</span>
<span class="sd">        with their computed magnitudes, astrometric information from</span>
<span class="sd">        GAIA DR3 data, best fitted model parameters and flags.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">ec</span> <span class="o">=</span> <span class="n">EC</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">generate_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            &lt;justify&gt; This function finds the best fitting model to the</span>
<span class="sd">            observed colors of the stellar source.</span>

<span class="sd">            The best fitting model is chosen from a combination</span>
<span class="sd">            of Kurucz/Castelli-Kurucz and Phoenix synthetic spectra </span>
<span class="sd">            convolved with the PANSTARRS response function (or </span>
<span class="sd">            BANDPASS) which is integrated w.r.t. the wavelength and</span>
<span class="sd">            normalised to the product of the PANSTARRS response</span>
<span class="sd">            function and wavelength. This is also called as </span>
<span class="sd">            Effective Stimulus (ES).</span>

<span class="sd">            $$</span>
<span class="sd">            ES = \\frac{\\int{F_{\\lambda}P_{\\lambda}{\\lambda}</span>
<span class="sd">            d{\\lambda}}}{\\int{P_{\\lambda}{\\lambda}d{\\lambda}}}</span>
<span class="sd">            $$</span>

<span class="sd">            The spectra is obtained from pysynphot [More information here](https://pysynphot.readthedocs.io)</span>
<span class="sd">            The model parameters are: $T_{eff}$, log(g) and [Fe/H].</span>

<span class="sd">            The range of models selected for fitting is:</span>

<span class="sd">            | Model Name    |               $T_{eff}$ (K)   |    log(g) (dex)  |    [Fe/H] (dex)|</span>
<span class="sd">            | :-------------| :-------------------------| :----------------| :--------------|</span>
<span class="sd">            | Phoenix (C1)  |                2800 - 5000 |    3.0 - 5.5    |     -5.0 - -1.5| </span>
<span class="sd">            | Phoenix (C2)  |              2800 - 4000   |   0.0 - 3.0     |     -0.5 - 1.5 | </span>
<span class="sd">            | Kurucz/Castelli-Kurucz (K0) |  4000 - 10000  |   ---         |       ---      | x`</span>
<span class="sd">            &lt;/justify&gt;</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'Computing the NIR magnitudes for the sources using the optimal method'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

            <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span>\
            <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span>\
            <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span>\
            <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
            <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span>\
            <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">extinction_corrected_photometry</span><span class="p">()</span>
            <span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">aj</span><span class="p">,</span><span class="n">ah</span><span class="p">,</span><span class="n">ak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">get_reddening</span><span class="p">()</span>
            <span class="n">gaia_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_gaia_data</span><span class="p">()</span>
            <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
            <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
            <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span>

            <span class="n">k0</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="s1">'Kurucz'</span><span class="p">)</span>
            <span class="n">k0</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">()</span>

            <span class="n">c1</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="s1">'Phoenix'</span><span class="p">)</span>
            <span class="n">c1</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">()</span>

            <span class="n">c2</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="s1">'Phoenix'</span><span class="p">)</span>
            <span class="n">c2</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">()</span>

            <span class="n">model_params_k0</span> <span class="o">=</span> <span class="n">k0</span><span class="o">.</span><span class="n">select_sam</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">4000</span><span class="p">,</span><span class="mi">10000</span><span class="p">],</span>
                                                <span class="n">logg_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feh_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">model_params_c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">select_sam</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">5000</span><span class="p">],</span>
                                                <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">],</span>
                                                <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">],</span>
                                                <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">model_params_c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">select_sam</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">4000</span><span class="p">],</span>
                                                <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">],</span>
                                                <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],</span>
                                                <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">teff_c1</span><span class="p">,</span> <span class="n">logg_c1</span><span class="p">,</span> <span class="n">feh_c1</span><span class="p">,</span> <span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_j_c1</span><span class="p">,</span>\
            <span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_k_c1</span> <span class="o">=</span> <span class="n">model_params_c1</span>
            <span class="n">teff_c2</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span>\
            <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_k_c2</span> <span class="o">=</span> <span class="n">model_params_c2</span>
            <span class="n">teff_k0</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">,</span>\
            <span class="n">sam_h_k0</span><span class="p">,</span> <span class="n">sam_k_k0</span> <span class="o">=</span> <span class="n">model_params_k0</span>

            <span class="n">teff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">teff_c1</span><span class="p">,</span> <span class="n">teff_c2</span><span class="p">,</span> <span class="n">teff_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">logg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">logg_c1</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">feh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">feh_c1</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_j_c1</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_h_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sam_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_k_c1</span><span class="p">,</span> <span class="n">sam_k_c2</span><span class="p">,</span> <span class="n">sam_k_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">sam_gr</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_r</span>
            <span class="n">sam_ri</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_i</span>
            <span class="n">sam_gi</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_i</span>
            <span class="n">sam_gz</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_z</span>
            <span class="n">sam_gy</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_y</span>
            <span class="n">sam_ry</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_y</span>
            <span class="n">sam_rz</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_z</span>
            <span class="n">sam_iz</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_z</span>
            <span class="n">sam_iy</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_y</span>
            <span class="n">sam_zy</span> <span class="o">=</span> <span class="n">sam_z</span> <span class="o">-</span> <span class="n">sam_y</span>

            <span class="n">observed_colours</span> <span class="o">=</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
            <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
            <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span>\
            <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_zmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">)</span>

            <span class="n">model_colours</span> <span class="o">=</span> <span class="n">sam_gr</span><span class="p">,</span> <span class="n">sam_gi</span><span class="p">,</span> <span class="n">sam_gz</span><span class="p">,</span> <span class="n">sam_gy</span><span class="p">,</span> <span class="n">sam_ri</span><span class="p">,</span> <span class="n">sam_rz</span><span class="p">,</span>\
            <span class="n">sam_ry</span><span class="p">,</span> <span class="n">sam_iz</span><span class="p">,</span> <span class="n">sam_iy</span><span class="p">,</span> <span class="n">sam_zy</span>

            <span class="n">observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span>\
                <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span>
            <span class="n">e_observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
                <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">e_ec_ymag</span>
            <span class="n">sam_magnitudes</span> <span class="o">=</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span>\
                <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ra_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span><span class="n">dec_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'IRGSC'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span><span class="o">+</span>\
                    <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">'UTF8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file1</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ec_gmag</span><span class="p">)):</span>
                    <span class="n">dquad_arr</span><span class="p">,</span> <span class="n">min_dquad</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> \
                        <span class="n">compute_dquad</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">oc</span> <span class="o">=</span> <span class="n">observed_colours</span><span class="p">,</span> <span class="n">mc</span> <span class="o">=</span> <span class="n">model_colours</span><span class="p">)</span>
                    <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">,</span><span class="n">min_dquad</span><span class="p">)</span>
                    <span class="n">index_best_fit_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_dquad_element</span><span class="o">==</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">sf_avg</span><span class="p">,</span><span class="n">sigma_sf</span><span class="p">,</span><span class="n">computed_j</span><span class="p">,</span><span class="n">computed_j_error</span><span class="p">,</span><span class="n">computed_h</span><span class="p">,</span><span class="n">computed_h_error</span><span class="p">,</span>\
                        <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="o">=</span><span class="n">calc_sf</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">observed_optical_magnitudes</span><span class="p">,</span>\
                                                            <span class="n">e_observed_optical_magnitudes</span><span class="p">,</span>\
                                                            <span class="n">sam_magnitudes</span><span class="p">,</span> <span class="n">index_best_fit_sam</span><span class="p">,</span>\
                                                            <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span><span class="p">)</span>
                    <span class="n">gaia_angular_seperation</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                                                            <span class="o">-</span><span class="n">gaia_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>
                                                            <span class="o">+</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaia_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gaia_angular_seperation</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                            <span class="n">gaia_ang_seperation_selected</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]</span>
                            <span class="n">min_gaia_ang_seperation</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span>\
                                <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gaia_ang_seperation_selected</span><span class="p">)</span>\
                                          <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

                            <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_gaia_ang_seperation</span> \
                                                                <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                            <span class="n">data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                                <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                                <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                                <span class="n">logg</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">sam_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                                <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">teff</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">sam_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span>\
                                <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">teff</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">sam_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                                <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                                <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._fitting.GenerateIRGSC.generate_irgsc">
<code class="highlight language-python"><span class="n">generate_irgsc</span><span class="p">(</span><span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p><justify> This function finds the best fitting model to the
observed colors of the stellar source.</justify></p>
<p>The best fitting model is chosen from a combination
of Kurucz/Castelli-Kurucz and Phoenix synthetic spectra 
convolved with the PANSTARRS response function (or 
BANDPASS) which is integrated w.r.t. the wavelength and
normalised to the product of the PANSTARRS response
function and wavelength. This is also called as 
Effective Stimulus (ES).</p>
<div class="arithmatex">\[
ES = \frac{\int{F_{\lambda}P_{\lambda}{\lambda}
d{\lambda}}}{\int{P_{\lambda}{\lambda}d{\lambda}}}
\]</div>
<p>The spectra is obtained from pysynphot <a href="https://pysynphot.readthedocs.io">More information here</a>
The model parameters are: <span class="arithmatex">\(T_{eff}\)</span>, log(g) and [Fe/H].</p>
<p>The range of models selected for fitting is:</p>
<table>
<thead>
<tr>
<th align="left">Model Name</th>
<th align="left"><span class="arithmatex">\(T_{eff}\)</span> (K)</th>
<th align="left">log(g) (dex)</th>
<th align="left">[Fe/H] (dex)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Phoenix (C1)</td>
<td align="left">2800 - 5000</td>
<td align="left">3.0 - 5.5</td>
<td align="left">-5.0 - -1.5</td>
</tr>
<tr>
<td align="left">Phoenix (C2)</td>
<td align="left">2800 - 4000</td>
<td align="left">0.0 - 3.0</td>
<td align="left">-0.5 - 1.5</td>
</tr>
<tr>
<td align="left">Kurucz/Castelli-Kurucz (K0)</td>
<td align="left">4000 - 10000</td>
<td align="left">---</td>
<td align="left">---</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">        &lt;justify&gt; This function finds the best fitting model to the</span>
<span class="sd">        observed colors of the stellar source.</span>

<span class="sd">        The best fitting model is chosen from a combination</span>
<span class="sd">        of Kurucz/Castelli-Kurucz and Phoenix synthetic spectra </span>
<span class="sd">        convolved with the PANSTARRS response function (or </span>
<span class="sd">        BANDPASS) which is integrated w.r.t. the wavelength and</span>
<span class="sd">        normalised to the product of the PANSTARRS response</span>
<span class="sd">        function and wavelength. This is also called as </span>
<span class="sd">        Effective Stimulus (ES).</span>

<span class="sd">        $$</span>
<span class="sd">        ES = \\frac{\\int{F_{\\lambda}P_{\\lambda}{\\lambda}</span>
<span class="sd">        d{\\lambda}}}{\\int{P_{\\lambda}{\\lambda}d{\\lambda}}}</span>
<span class="sd">        $$</span>

<span class="sd">        The spectra is obtained from pysynphot [More information here](https://pysynphot.readthedocs.io)</span>
<span class="sd">        The model parameters are: $T_{eff}$, log(g) and [Fe/H].</span>

<span class="sd">        The range of models selected for fitting is:</span>

<span class="sd">        | Model Name    |               $T_{eff}$ (K)   |    log(g) (dex)  |    [Fe/H] (dex)|</span>
<span class="sd">        | :-------------| :-------------------------| :----------------| :--------------|</span>
<span class="sd">        | Phoenix (C1)  |                2800 - 5000 |    3.0 - 5.5    |     -5.0 - -1.5| </span>
<span class="sd">        | Phoenix (C2)  |              2800 - 4000   |   0.0 - 3.0     |     -0.5 - 1.5 | </span>
<span class="sd">        | Kurucz/Castelli-Kurucz (K0) |  4000 - 10000  |   ---         |       ---      | x`</span>
<span class="sd">        &lt;/justify&gt;</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">use_optimal_method</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Computing the NIR magnitudes for the sources using the optimal method'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'#########################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>

        <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">gkron</span><span class="p">,</span> <span class="n">e_gkron</span><span class="p">,</span>\
        <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">rkron</span><span class="p">,</span> <span class="n">e_rkron</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ikron</span><span class="p">,</span> <span class="n">e_ikron</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span>\
        <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">zkron</span><span class="p">,</span> <span class="n">e_zkron</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">ykron</span><span class="p">,</span> <span class="n">e_ykron</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span>\
        <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
        <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span> <span class="n">zinfoflag3</span><span class="p">,</span>\
        <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">extinction_corrected_photometry</span><span class="p">()</span>
        <span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">aj</span><span class="p">,</span><span class="n">ah</span><span class="p">,</span><span class="n">ak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ec</span><span class="o">.</span><span class="n">get_reddening</span><span class="p">()</span>
        <span class="n">gaia_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_gaia_data</span><span class="p">()</span>
        <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
        <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
        <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">gaia_data</span>

        <span class="n">k0</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="s1">'Kurucz'</span><span class="p">)</span>
        <span class="n">k0</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">()</span>

        <span class="n">c1</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="s1">'Phoenix'</span><span class="p">)</span>
        <span class="n">c1</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">()</span>

        <span class="n">c2</span> <span class="o">=</span> <span class="n">Models</span><span class="p">(</span><span class="s1">'Phoenix'</span><span class="p">)</span>
        <span class="n">c2</span><span class="o">.</span><span class="n">read_sam_file</span><span class="p">()</span>

        <span class="n">model_params_k0</span> <span class="o">=</span> <span class="n">k0</span><span class="o">.</span><span class="n">select_sam</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">4000</span><span class="p">,</span><span class="mi">10000</span><span class="p">],</span>
                                            <span class="n">logg_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feh_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                            <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">model_params_c1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">select_sam</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">5000</span><span class="p">],</span>
                                            <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">],</span>
                                            <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">],</span>
                                            <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">model_params_c2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">select_sam</span><span class="p">(</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2800</span><span class="p">,</span><span class="mi">4000</span><span class="p">],</span>
                                            <span class="n">logg_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">],</span>
                                            <span class="n">feh_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],</span>
                                            <span class="n">use_optimal_method</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">teff_c1</span><span class="p">,</span> <span class="n">logg_c1</span><span class="p">,</span> <span class="n">feh_c1</span><span class="p">,</span> <span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_j_c1</span><span class="p">,</span>\
        <span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_k_c1</span> <span class="o">=</span> <span class="n">model_params_c1</span>
        <span class="n">teff_c2</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span>\
        <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_k_c2</span> <span class="o">=</span> <span class="n">model_params_c2</span>
        <span class="n">teff_k0</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">,</span>\
        <span class="n">sam_h_k0</span><span class="p">,</span> <span class="n">sam_k_k0</span> <span class="o">=</span> <span class="n">model_params_k0</span>

        <span class="n">teff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">teff_c1</span><span class="p">,</span> <span class="n">teff_c2</span><span class="p">,</span> <span class="n">teff_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">logg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">logg_c1</span><span class="p">,</span> <span class="n">logg_c2</span><span class="p">,</span> <span class="n">logg_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">feh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">feh_c1</span><span class="p">,</span> <span class="n">feh_c2</span><span class="p">,</span> <span class="n">feh_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_g_c1</span><span class="p">,</span> <span class="n">sam_g_c2</span><span class="p">,</span> <span class="n">sam_g_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_r_c1</span><span class="p">,</span> <span class="n">sam_r_c2</span><span class="p">,</span> <span class="n">sam_r_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_i_c1</span><span class="p">,</span> <span class="n">sam_i_c2</span><span class="p">,</span> <span class="n">sam_i_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_z_c1</span><span class="p">,</span> <span class="n">sam_z_c2</span><span class="p">,</span> <span class="n">sam_z_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_y_c1</span><span class="p">,</span> <span class="n">sam_y_c2</span><span class="p">,</span> <span class="n">sam_y_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_j_c1</span><span class="p">,</span> <span class="n">sam_j_c2</span><span class="p">,</span> <span class="n">sam_j_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_h_c1</span><span class="p">,</span> <span class="n">sam_h_c2</span><span class="p">,</span> <span class="n">sam_h_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sam_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">sam_k_c1</span><span class="p">,</span> <span class="n">sam_k_c2</span><span class="p">,</span> <span class="n">sam_k_k0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">sam_gr</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_r</span>
        <span class="n">sam_ri</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_i</span>
        <span class="n">sam_gi</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_i</span>
        <span class="n">sam_gz</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_z</span>
        <span class="n">sam_gy</span> <span class="o">=</span> <span class="n">sam_g</span> <span class="o">-</span> <span class="n">sam_y</span>
        <span class="n">sam_ry</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_y</span>
        <span class="n">sam_rz</span> <span class="o">=</span> <span class="n">sam_r</span> <span class="o">-</span> <span class="n">sam_z</span>
        <span class="n">sam_iz</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_z</span>
        <span class="n">sam_iy</span> <span class="o">=</span> <span class="n">sam_i</span> <span class="o">-</span> <span class="n">sam_y</span>
        <span class="n">sam_zy</span> <span class="o">=</span> <span class="n">sam_z</span> <span class="o">-</span> <span class="n">sam_y</span>

        <span class="n">observed_colours</span> <span class="o">=</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
        <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_rmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_gmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_imag</span><span class="p">),</span>\
        <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_rmag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_zmag</span><span class="p">),</span>\
        <span class="p">(</span><span class="n">ec_imag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">),</span> <span class="p">(</span><span class="n">ec_zmag</span> <span class="o">-</span> <span class="n">ec_ymag</span><span class="p">)</span>

        <span class="n">model_colours</span> <span class="o">=</span> <span class="n">sam_gr</span><span class="p">,</span> <span class="n">sam_gi</span><span class="p">,</span> <span class="n">sam_gz</span><span class="p">,</span> <span class="n">sam_gy</span><span class="p">,</span> <span class="n">sam_ri</span><span class="p">,</span> <span class="n">sam_rz</span><span class="p">,</span>\
        <span class="n">sam_ry</span><span class="p">,</span> <span class="n">sam_iz</span><span class="p">,</span> <span class="n">sam_iy</span><span class="p">,</span> <span class="n">sam_zy</span>

        <span class="n">observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span>\
            <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span>
        <span class="n">e_observed_optical_magnitudes</span> <span class="o">=</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
            <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">e_ec_ymag</span>
        <span class="n">sam_magnitudes</span> <span class="o">=</span> <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span>\
            <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ra_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span><span class="n">dec_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'IRGSC'</span><span class="o">+</span><span class="s1">'_'</span><span class="o">+</span><span class="s1">'RA'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span><span class="o">+</span><span class="s1">'DEC'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span><span class="o">+</span>\
                <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span><span class="o">+</span><span class="s1">'.csv'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">'UTF8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file1</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ec_gmag</span><span class="p">)):</span>
                <span class="n">dquad_arr</span><span class="p">,</span> <span class="n">min_dquad</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> \
                    <span class="n">compute_dquad</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">oc</span> <span class="o">=</span> <span class="n">observed_colours</span><span class="p">,</span> <span class="n">mc</span> <span class="o">=</span> <span class="n">model_colours</span><span class="p">)</span>
                <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">,</span><span class="n">min_dquad</span><span class="p">)</span>
                <span class="n">index_best_fit_sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_dquad_element</span><span class="o">==</span><span class="p">(</span><span class="n">dquad_arr</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sf_avg</span><span class="p">,</span><span class="n">sigma_sf</span><span class="p">,</span><span class="n">computed_j</span><span class="p">,</span><span class="n">computed_j_error</span><span class="p">,</span><span class="n">computed_h</span><span class="p">,</span><span class="n">computed_h_error</span><span class="p">,</span>\
                    <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="o">=</span><span class="n">calc_sf</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">observed_optical_magnitudes</span><span class="p">,</span>\
                                                        <span class="n">e_observed_optical_magnitudes</span><span class="p">,</span>\
                                                        <span class="n">sam_magnitudes</span><span class="p">,</span> <span class="n">index_best_fit_sam</span><span class="p">,</span>\
                                                        <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span><span class="p">)</span>
                <span class="n">gaia_angular_seperation</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                                                        <span class="o">-</span><span class="n">gaia_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>
                                                        <span class="o">+</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaia_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gaia_angular_seperation</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">gaia_ang_seperation_selected</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]</span>
                        <span class="n">min_gaia_ang_seperation</span> <span class="o">=</span> <span class="n">gaia_angular_seperation</span>\
                            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gaia_ang_seperation_selected</span><span class="p">)</span>\
                                      <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="n">index_min_ang_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">min_gaia_ang_seperation</span> \
                                                            <span class="o">==</span> <span class="n">gaia_angular_seperation</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

                        <span class="n">data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                            <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                            <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                            <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> \
                            <span class="n">logg</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">sam_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                            <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                            <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">teff</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">sam_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                            <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span>\
                            <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_min_ang_seperation</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">teff</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">sam_y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                            <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>\
                            <span class="n">objinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>\
                            <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="irgsctool._fitting.calc_sf">
<code class="highlight language-python"><span class="n">calc_sf</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">om</span><span class="p">,</span> <span class="n">e_om</span><span class="p">,</span> <span class="n">sm</span><span class="p">,</span> <span class="n">index_min_ang_seperation</span><span class="p">,</span> <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>This function calculates the scale factor using
the best fitted model to the observed data. The
scale factor is defined as the difference in the
observed and the model magnitudes.</p>
<p>Computed NIR magnitudes are found by adding the
scale factor to the model NIR magnitudes generated
by integrating the convolved UKIDSS response function,
the model flux and wavelength normalised to the 
integral of UKIDSS response f</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sf_mean</code></td> <td>
</td>
<td><p>Scale Factor averaged over the PANSTARRS colors</p></td>
</tr>
<tr>
<td><code>e_sf_mean</code></td> <td>
</td>
<td><p>error in the scale factor</p></td>
</tr>
<tr>
<td><code>cj</code></td> <td>
</td>
<td><p>computed J magnitude</p></td>
</tr>
<tr>
<td><code>ch</code></td> <td>
</td>
<td><p>computed H magnitude</p></td>
</tr>
<tr>
<td><code>ck</code></td> <td>
</td>
<td><p>computed K magnitude</p></td>
</tr>
<tr>
<td></td> <td>
</td>
<td><p>e_cj, e_ch, e_ck: errors in the computed NIR magnitudes</p></td>
</tr>
</tbody>
</table>
<p>The NIR magnitudes are returned in Vega system.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calc_sf</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">om</span><span class="p">,</span> <span class="n">e_om</span><span class="p">,</span> <span class="n">sm</span><span class="p">,</span> <span class="n">index_min_ang_seperation</span><span class="p">,</span> <span class="n">aj</span><span class="p">,</span> <span class="n">ah</span><span class="p">,</span> <span class="n">ak</span><span class="p">):</span>

<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        This function calculates the scale factor using</span>
<span class="sd">        the best fitted model to the observed data. The</span>
<span class="sd">        scale factor is defined as the difference in the</span>
<span class="sd">        observed and the model magnitudes.</span>

<span class="sd">        Computed NIR magnitudes are found by adding the</span>
<span class="sd">        scale factor to the model NIR magnitudes generated</span>
<span class="sd">        by integrating the convolved UKIDSS response function,</span>
<span class="sd">        the model flux and wavelength normalised to the </span>
<span class="sd">        integral of UKIDSS response f</span>

<span class="sd">        Returns:</span>
<span class="sd">                sf_mean: Scale Factor averaged over the PANSTARRS colors</span>
<span class="sd">                e_sf_mean: error in the scale factor</span>
<span class="sd">                cj: computed J magnitude</span>
<span class="sd">                ch: computed H magnitude</span>
<span class="sd">                ck: computed K magnitude</span>
<span class="sd">                e_cj, e_ch, e_ck: errors in the computed NIR magnitudes</span>
<span class="sd">        The NIR magnitudes are returned in Vega system.</span>
<span class="sd">        """</span>

        <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">om</span>
        <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">e_om</span>
        <span class="n">sam_g</span><span class="p">,</span> <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span> <span class="o">=</span> <span class="n">sm</span>

        <span class="n">sf_mean</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">])</span>\
                           <span class="o">+</span><span class="p">(</span><span class="n">ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_r</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">])</span>\
                                <span class="o">+</span><span class="p">(</span><span class="n">ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">])</span>\
                                    <span class="o">+</span><span class="p">(</span><span class="n">ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">])</span>\
                                        <span class="o">+</span> <span class="p">(</span><span class="n">ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]))</span>

        <span class="n">e_sf_mean</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>\
                                <span class="o">+</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>  <span class="o">+</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

        <span class="c1">#0.91 is the conversion constant from J_AB to J_Vega</span>
        <span class="c1">#1.39 is the conversion constant from H_AB to H_Vega</span>
        <span class="c1">#1.85 is the conversion constant from K_AB to K_Vega</span>

        <span class="n">cj</span> <span class="o">=</span> <span class="n">sf_mean</span> <span class="o">+</span> <span class="n">aj</span> <span class="o">+</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.91</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">sf_mean</span> <span class="o">+</span> <span class="n">ah</span> <span class="o">+</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.39</span>
        <span class="n">ck</span> <span class="o">=</span> <span class="n">sf_mean</span> <span class="o">+</span> <span class="n">ak</span> <span class="o">+</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">index_min_ang_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.85</span>

        <span class="n">e_cj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e_sf_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="c1"># + (self.e_aj)**2)</span>
        <span class="n">e_ch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e_sf_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="c1"># + (self.e_ah)**2)</span>
        <span class="n">e_ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e_sf_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="c1"># + (self.e_ak)**2)</span>

        <span class="k">return</span> <span class="n">sf_mean</span><span class="p">,</span> <span class="n">e_sf_mean</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">e_cj</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">e_ch</span><span class="p">,</span> <span class="n">ck</span><span class="p">,</span> <span class="n">e_ck</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="irgsctool._fitting.compute_dquad">
<code class="highlight language-python"><span class="n">compute_dquad</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">oc</span><span class="p">,</span> <span class="n">mc</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>Calculates the quantity d_quad which is the cumulative difference
in the observed and the model colors.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_dquad</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">oc</span><span class="p">,</span> <span class="n">mc</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            Calculates the quantity d_quad which is the cumulative difference</span>
<span class="sd">            in the observed and the model colors.</span>

<span class="sd">        """</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="n">obs_gr</span><span class="p">,</span> <span class="n">obs_gi</span><span class="p">,</span> <span class="n">obs_gz</span><span class="p">,</span> <span class="n">obs_gy</span><span class="p">,</span> <span class="n">obs_ri</span><span class="p">,</span> <span class="n">obs_ry</span><span class="p">,</span> <span class="n">obs_rz</span><span class="p">,</span> <span class="n">obs_iz</span><span class="p">,</span> <span class="n">obs_iy</span><span class="p">,</span> <span class="n">obs_zy</span> <span class="o">=</span> <span class="n">oc</span>
        <span class="n">sam_gr</span><span class="p">,</span> <span class="n">sam_gi</span><span class="p">,</span> <span class="n">sam_gz</span><span class="p">,</span> <span class="n">sam_gy</span><span class="p">,</span> <span class="n">sam_ri</span><span class="p">,</span> <span class="n">sam_rz</span><span class="p">,</span> <span class="n">sam_ry</span><span class="p">,</span> <span class="n">sam_iz</span><span class="p">,</span> <span class="n">sam_iy</span><span class="p">,</span> <span class="n">sam_zy</span> <span class="o">=</span> <span class="n">mc</span>
        <span class="n">dev_gr</span> <span class="o">=</span> <span class="n">obs_gr</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_gr</span>
        <span class="n">dev_gi</span> <span class="o">=</span> <span class="n">obs_gi</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_gi</span>
        <span class="n">dev_gz</span> <span class="o">=</span> <span class="n">obs_gz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_gz</span>
        <span class="n">dev_gy</span> <span class="o">=</span> <span class="n">obs_gy</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_gy</span>
        <span class="n">dev_ri</span> <span class="o">=</span> <span class="n">obs_ri</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_ri</span>
        <span class="n">dev_rz</span> <span class="o">=</span> <span class="n">obs_rz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_rz</span>
        <span class="n">dev_ry</span> <span class="o">=</span> <span class="n">obs_ry</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_ry</span>
        <span class="n">dev_iz</span> <span class="o">=</span> <span class="n">obs_iz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_iz</span>
        <span class="n">dev_iy</span> <span class="o">=</span> <span class="n">obs_iy</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_iy</span>
        <span class="n">dev_zy</span> <span class="o">=</span> <span class="n">obs_zy</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">sam_zy</span>
        <span class="n">dquad</span> <span class="o">=</span> <span class="n">dev_gr</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_gi</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_gz</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_gy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_ri</span><span class="o">**</span><span class="mi">2</span>\
                 <span class="o">+</span> <span class="n">dev_rz</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_ry</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_iz</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_iy</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dev_zy</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">dquad</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dquad</span><span class="p">),</span> <span class="n">dev_gr</span><span class="p">,</span> <span class="n">dev_gi</span><span class="p">,</span> <span class="n">dev_gz</span><span class="p">,</span> <span class="n">dev_gy</span><span class="p">,</span> <span class="n">dev_ri</span><span class="p">,</span>\
            <span class="n">dev_rz</span><span class="p">,</span> <span class="n">dev_ry</span><span class="p">,</span> <span class="n">dev_iz</span><span class="p">,</span> <span class="n">dev_iy</span><span class="p">,</span> <span class="n">dev_zy</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="irgsctool._fitting.find_nearest">
<code class="highlight language-python"><span class="n">find_nearest</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>function to find the nearest element
in an array to the given value</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_nearest</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    function to find the nearest element</span>
<span class="sd">    in an array to the given value</span>
<span class="sd">    """</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">array</span> <span class="o">-</span> <span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="irgsctool._fitting.stdv">
<code class="highlight language-python"><span class="n">stdv</span><span class="p">(</span><span class="n">sfavg</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="n">v5</span><span class="p">)</span></code>
</h2>
<div class="doc doc-contents">
<p>function to calculate standard deviation</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_fitting.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stdv</span><span class="p">(</span><span class="n">sfavg</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="n">v5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">          function to calculate standard deviation</span>
<span class="sd">    """</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">sfavg</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">sig</span> <span class="o">=</span> <span class="p">(((</span><span class="n">mu</span> <span class="o">-</span> <span class="n">v1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">v2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">v3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">v4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">v5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">sig</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div><h2 id="validate-the-generated-irgsc">Validate the generated IRGSC</h2>
<div class="doc doc-object doc-module">
<a id="irgsctool._validate"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._validate.Validate">
<code>Validate</code>
</h2>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Validate</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                      <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">];</span> <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">];</span> \
            <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">];</span> <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">];</span> \
            <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">];</span> <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">];</span> <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">];</span> <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">];</span> \
            <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">];</span> <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">];</span> <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">];</span> <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">];</span> \
                <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">];</span> <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">];</span> <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">];</span> <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">];</span> <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">];</span> <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">];</span>\
                <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">];</span> <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">];</span> <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">];</span> <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">];</span> <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">];</span> <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">];</span>\
                    <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">];</span> <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">];</span> <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">];</span> <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">];</span>\
                    <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">];</span> <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">];</span> <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">];</span>\
                        <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">];</span> <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">];</span> <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">];</span>\
                        <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">];</span> <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">];</span> <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">];</span>\
                            <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">];</span> <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">];</span> <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">];</span> <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">];</span>\
                            <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">];</span> <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">];</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">];</span>\
                                <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">];</span> <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">];</span> <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">];</span>\
                                    <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">];</span> <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">];</span> <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">];</span>\
                                        <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">];</span> <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">];</span> <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">];</span>\
                                        <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">];</span> <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">];</span> <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">];</span>\
                                            <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">];</span> <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">];</span> <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">];</span>\
                                            <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">];</span> <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">];</span> <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">];</span>\
                                            <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
            <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
                <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
                <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                    <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                    <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                        <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                        <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                            <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                            <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">gc</span> <span class="o">=</span> <span class="n">GenerateIRGSC</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">generate_irgsc</span><span class="p">()</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                      <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">];</span> <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">];</span> \
            <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">];</span> <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">];</span> \
            <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">];</span> <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">];</span> <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">];</span> <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">];</span> \
            <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">];</span> <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">];</span> <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">];</span> <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">];</span> \
                <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">];</span> <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">];</span> <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">];</span> <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">];</span> <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">];</span> <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">];</span>\
                <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">];</span> <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">];</span> <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">];</span> <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">];</span> <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">];</span> <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">];</span>\
                    <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">];</span> <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">];</span> <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">];</span> <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">];</span>\
                    <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">];</span> <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">];</span> <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">];</span>\
                        <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">];</span> <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">];</span> <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">];</span>\
                        <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">];</span> <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">];</span> <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">];</span>\
                            <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">];</span> <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">];</span> <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">];</span> <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">];</span>\
                            <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">];</span> <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">];</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">];</span>\
                                <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">];</span> <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">];</span> <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">];</span>\
                                    <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">];</span> <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">];</span> <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">];</span>\
                                        <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">];</span> <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">];</span> <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">];</span>\
                                        <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">];</span> <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">];</span> <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">];</span>\
                                            <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">];</span> <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">];</span> <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">];</span>\
                                            <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">];</span> <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">];</span> <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">];</span>\
                                            <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
            <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
                <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
                <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                    <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                    <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                        <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                        <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                            <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                            <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
        <span class="k">return</span> <span class="n">irgsc_data</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            Function to compare the observed and computed NIR magnitudes for a given field.</span>
<span class="sd">            If this is set to True, the function first obtains the UKIDSS data for the given field.</span>
<span class="sd">            Raises an error if UKIDSS data is not available.</span>
<span class="sd">            Raises warning if J and H band data from UKIDSS is not available.</span>
<span class="sd">        """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Now validating the generated IRGSC using the UKIDSS data file if it is present.'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">validate</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ukidss_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">()</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_irgsc</span><span class="p">()</span>
            <span class="n">ukidss_j</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">,</span> <span class="n">ukidss_ra</span><span class="p">,</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span>
            <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span>\
                <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span>\
                <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span><span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                    <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span>\
                        <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span>\
                            <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                            <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span> <span class="n">gaia_pm_dec_error</span><span class="p">,</span>\
                                <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span>\
                                <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>\
                                    <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                                    <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span>

        <span class="n">validate_params</span><span class="o">=</span><span class="p">[];</span> <span class="n">ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_k</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_k</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">diff_jf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_hf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_kf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span> <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'validated_IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file2</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ps_ra</span><span class="p">)):</span>
                <span class="c1">#positionally matching the sources in the UKIDSS within 1" to the PS1 sources in the catalogue</span>
                <span class="n">gamma_ukidss</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>\
                                      <span class="o">+</span> <span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">index_ukidss_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gamma_ukidss</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">matched_positions</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                    <span class="n">minimum_seperation</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">matched_positions</span><span class="p">)</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">index_minimum_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">minimum_seperation</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                    <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span>\
                    <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                    <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                    <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                    <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                    <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span>\
                    <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                    <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                    <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                    <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>

        <span class="n">indjp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indhp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indkp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">e_ob_j</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $J_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obj_vs_err_obj.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">e_ob_h</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $H_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obh_vs_err_obh.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">e_ob_k</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $K_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obk_vs_err_obk.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>


        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">diff_jf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                        <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                    <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                    <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($J_</span><span class="si">{o}</span><span class="s1">$ - $J_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indjp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed J magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $J_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_j'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                    <span class="o">+</span><span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">diff_hf</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">diff_hf</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">diff_hf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                            <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                 <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($H_</span><span class="si">{o}</span><span class="s1">$ - $H_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indhp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed H magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $H_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_h'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                    <span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">diff_kf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                             <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                        <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                    <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                                        <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($K_</span><span class="si">{o}</span><span class="s1">$ - $K_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span>\
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indkp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed K magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $K_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_k'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                    <span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._validate.Validate.validate">
<code class="highlight language-python"><span class="n">validate</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Function to compare the observed and computed NIR magnitudes for a given field.
If this is set to True, the function first obtains the UKIDSS data for the given field.
Raises an error if UKIDSS data is not available.
Raises warning if J and H band data from UKIDSS is not available.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">        Function to compare the observed and computed NIR magnitudes for a given field.</span>
<span class="sd">        If this is set to True, the function first obtains the UKIDSS data for the given field.</span>
<span class="sd">        Raises an error if UKIDSS data is not available.</span>
<span class="sd">        Raises warning if J and H band data from UKIDSS is not available.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Now validating the generated IRGSC using the UKIDSS data file if it is present.'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">validate</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ukidss_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">()</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_irgsc</span><span class="p">()</span>
        <span class="n">ukidss_j</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">,</span> <span class="n">ukidss_ra</span><span class="p">,</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span>
        <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span>\
            <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span>\
            <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span><span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span>\
                    <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span>\
                        <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                        <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span> <span class="n">gaia_pm_dec_error</span><span class="p">,</span>\
                            <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span>\
                            <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>\
                                <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                                <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span>

    <span class="n">validate_params</span><span class="o">=</span><span class="p">[];</span> <span class="n">ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_k</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_k</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">diff_jf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_hf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_kf</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span> <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'validated_IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file2</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ps_ra</span><span class="p">)):</span>
            <span class="c1">#positionally matching the sources in the UKIDSS within 1" to the PS1 sources in the catalogue</span>
            <span class="n">gamma_ukidss</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>\
                                  <span class="o">+</span> <span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">index_ukidss_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gamma_ukidss</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">matched_positions</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                <span class="n">minimum_seperation</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">matched_positions</span><span class="p">)</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">index_minimum_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">minimum_seperation</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span>\
                <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span>\
                <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>

    <span class="n">indjp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">indhp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">indkp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">e_ob_j</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $J_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obj_vs_err_obj.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">e_ob_h</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $H_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obh_vs_err_obh.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">e_ob_k</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $K_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obk_vs_err_obk.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>


    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">diff_jf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                    <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($J_</span><span class="si">{o}</span><span class="s1">$ - $J_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indjp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed J magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $J_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_j'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                <span class="o">+</span><span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">diff_hf</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">diff_hf</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">diff_hf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                        <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                            <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                             <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($H_</span><span class="si">{o}</span><span class="s1">$ - $H_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indhp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed H magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $H_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_h'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                <span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">diff_kf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                         <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                    <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                                    <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($K_</span><span class="si">{o}</span><span class="s1">$ - $K_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span>\
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indkp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed K magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $K_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_k'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                <span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="about.html" title="About"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="apireference.html" title="API">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="about.html" style="color: #fcfcfc">Â« Previous</a></span>
<span><a href="apireference.html" style="color: #fcfcfc">Next Â»</a></span>
</span>
</div>
<script>var base_url = '.';</script>
<script defer="" src="js/theme_extra.js"></script>
<script defer="" src="js/theme.js"></script>
<script defer="" src="javascripts/mathjax.js"></script>
<script defer="" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
<script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});</script></body>
</html>
